\documentclass[11pt]{article}
\usepackage{../HPpack}

\newgeometry{left = 0in, right = 0in, top = 0in, bottom = 0in}

\usepackage{tikz}
\usetikzlibrary{positioning}
\usepackage{lscape}


\def\maxHeight{21.2}
\def\heightUnits{\maxHeight/100}
\def\maxWidth{27.6}
\def\widthUnits{\maxWidth/100}

\begin{document}

\begin{landscape}

\begin{tikzpicture}

\node at (0,0) {};
\node at (0,\maxHeight) {};
\node at (\maxWidth,\maxHeight) {};
\node at (\maxWidth,0) {};

\def\leftLimit{0*\widthUnits}
\def\halfDivider{45*\heightUnits}
\def\rightColumn{35*\widthUnits}

\def\sqrtTwo{1.4142135623730951}
\def\boxDim{1.3*\widthUnits};
\def\boxSmall{0.9*\widthUnits};
\def\boxTiny{0.5*\widthUnits}
\renewcommand\square[4]
{
	\draw[fill=#4,rotate around ={45:({#1},{#2})},#3] ({#1-\boxDim/2},{#2-\boxDim/2}) rectangle ({#1+\boxDim/2},{#2+\boxDim/2});
}

\newcommand\smallDot[3]
{
	\draw[fill=#3,rotate around ={45:({#1},{#2})}] ({#1-\boxSmall/2},{#2-\boxSmall/2}) rectangle ({#1+\boxSmall/2},{#2+\boxSmall/2});
}
\newcommand\tinyDot[3]
{
	\draw[fill=#3,rotate around ={45:({#1},{#2})}] ({#1-\boxTiny/2},{#2-\boxTiny/2}) rectangle ({#1+\boxTiny/2},{#2+\boxTiny/2});
}



%%%% CHARACTER BOX

\def\characterBoxTop{\maxHeight - 1*\heightUnits}
\def\characterGap{4.5 * \heightUnits}

\draw[rounded corners,gray!70,fill=gray!10] ({\leftLimit},{\halfDivider+ 0.5*\heightUnits})rectangle ({\rightColumn},{\characterBoxTop});

\def\entryTop{\characterBoxTop - 3*\heightUnits};

\node at ({(\leftLimit + \rightColumn)/2},{\entryTop}) {\HP \LARGE Character};
\foreach \entry [count = \c from 1] in {{Name}, {Family}, {Personality}, {Archetype} }
{
	\def\y{\entryTop-\c*\characterGap};
	\node[anchor = west] (A) at ({\leftLimit}, {\y})  {\large \key{\entry:}};
}
\def\subBoxesTop{\entryTop - 3*\heightUnits - 4*\characterGap}
\def\subBoxesDelta{\widthUnits};
\def\subBoxesBottom{\halfDivider + 1.2*\heightUnits};
\def\subBoxesWidth{(\rightColumn-\leftLimit)/2 - 2*\subBoxesDelta};



%%EXP box
\draw[rounded corners, gray!70, fill = gray!35] ({\leftLimit+\subBoxesDelta}, {\subBoxesTop}) rectangle ({(\rightColumn+\leftLimit)/2 - \subBoxesDelta},{\subBoxesBottom}); 
\def\gapFac{1.5}
\def\miniBoxesWidth{\boxDim*6*\gapFac};
\def\modDelta{(\subBoxesWidth-\miniBoxesWidth)/2};
\def\initX{\leftLimit + \subBoxesDelta+\modDelta}
\def\expGap{5 * \heightUnits}
\node at ({\leftLimit + \subBoxesDelta + (\subBoxesWidth)/2},{\subBoxesTop-\heightUnits}) {\imp{Experience}};

\foreach \c in {0,1,2,3,4,5,6}
{
	\def\x{\initX + \c*1.5*\boxDim};
	\square{\x}{\subBoxesTop - \expGap}{}{white}
}

\node[anchor = west] at ({\leftLimit + \subBoxesDelta},{\subBoxesTop -\expGap - 2.5 *\boxDim}) {\scriptsize Experience Triggers:};
\def\subExpGap{3.3*\heightUnits}
\def\bulletR{0.2*\heightUnits}
\foreach \c in {1,2,3,4,5}
{
	\def\y{\subBoxesTop - \expGap - 2.5*\boxDim - \c*\subExpGap}
	\draw[fill = black] ({\leftLimit + \subBoxesDelta + \subExpGap}, {\y+\bulletR}) circle (\bulletR);
	\draw[gray!70]({\leftLimit + \subBoxesDelta + \subExpGap+6*\bulletR}, {\y-4*\bulletR}) -- ({\leftLimit + \subBoxesDelta + \subBoxesWidth - \subBoxesDelta}, {\y-4*\bulletR});
}

\draw[rounded corners, gray!70, fill = gray!35] ({(\rightColumn+\leftLimit)/2 + \subBoxesDelta}, {\subBoxesTop}) rectangle ({\rightColumn - \subBoxesDelta},{\subBoxesBottom}); 
\node at ({\leftLimit + \subBoxesDelta + (\subBoxesWidth)/2},{\subBoxesTop-\heightUnits}) {\imp{Experience}};


\node at ({\leftLimit + 3*\subBoxesDelta + 3*(\subBoxesWidth)/2},{\subBoxesTop-\heightUnits}) {\imp{Nourishment}};

\newdimen\myunit
\pgfextractx{\myunit}{\pgfpointxy{{\subBoxesWidth-\subBoxesDelta/2}}{0}}
\node[anchor = north west] at ({\leftLimit + 3*\subBoxesDelta + (\subBoxesWidth)},{\subBoxesTop-2.8*\heightUnits}) {\parbox[t]{1\myunit}{\raggedright \scriptsize Doing \imp{Nourishing} activities restores \key{Fortitude}}};

\node[anchor = west] at ({\leftLimit + 3*\subBoxesDelta + (\subBoxesWidth)},{\subBoxesTop -\expGap - 2.5 *\boxDim}) {\scriptsize Nourishment Triggers:};
\foreach \c in {1,2,3,4,5}
{
	\def\y{\subBoxesTop - \expGap - 2.5*\boxDim - \c*\subExpGap}
	\draw[fill = black] ({\leftLimit + \subBoxesWidth + 3*\subBoxesDelta + \subExpGap}, {\y}) circle (\bulletR);
	
	\if\c1
			\node[anchor=west] at ({\leftLimit + +\subBoxesWidth + 3*\subBoxesDelta + \subExpGap+6*\bulletR}, {\y}) {\scriptsize \imp{Sleeping (1/day)}};
	\else
		\if\c2
			\node[anchor = west] at ({\leftLimit + +\subBoxesWidth + 3*\subBoxesDelta + \subExpGap+6*\bulletR}, {\y}) {\scriptsize \imp{Eating (2/day)}};
		\else
			\draw[gray!70]({\leftLimit + +\subBoxesWidth + 3*\subBoxesDelta + \subExpGap+6*\bulletR}, {\y-4*\bulletR}) -- ({\rightColumn - 2*\subBoxesDelta}, {\y-4*\bulletR});
		\fi
	\fi
}






%%% ASPECT BOX


\def\ry{0.7}


\def\interAspectGap{0.8*\widthUnits}
\def\aspectSectionSize{ (\rightColumn - \leftLimit - 2*\subBoxesDelta - 2 * \interAspectGap)/3}
\def\aspectBoxHeight{\aspectSectionSize/2.2}
\def\aspectTop{\halfDivider - 4*\heightUnits};
\def\aspectVerticalGap{2*\heightUnits}
\def\interDotGap{(\aspectSectionSize - 7*1.42*\boxSmall)/8};
\draw[rounded corners, gray!70, fill = gray!10] ({\leftLimit},{\halfDivider - 0.5*\heightUnits}) rectangle ({\rightColumn},{0});
\node at ({(\leftLimit + \rightColumn)/2},{\aspectTop}) {\HP \LARGE Aspects};


\foreach \Row [count = \i from 0] in { { {Fitness}, {Charm}, {Intelligence} },  { {Precision}, {Deception} , {Willpower} },   { {Vitality}, {Insight} , {Perception} },   }
{
	\def\y{ \halfDivider - 9*\heightUnits - \i*(\aspectBoxHeight*(1+1/6)+\ry + \aspectVerticalGap)}
	
	\foreach \entry [count = \j from 0] in \Row
	{
		\def\x{ \leftLimit + \subBoxesDelta + \aspectSectionSize/2+ \j * (\aspectSectionSize+\interAspectGap) }
		
		\draw[rounded corners,gray!70,fill=gray!35] ({\x- \aspectSectionSize/2},{\y+\aspectSectionSize/6}) rectangle ({\x+ \aspectSectionSize/2},{\y -\aspectBoxHeight});
		\node at ({\x}, {\y}) {\key{\entry}};
		
	
		\draw[domain = 0:360, variable = \t,samples = 30,gray!70,fill = gray!20] plot ({\x + (\aspectSectionSize/2)*cos(\t))}, {\y-\aspectBoxHeight-\ry*sin(\t)});
		
		\foreach \k in {0,1,2,3,4,5,6}
		{
			
			\def\xCirc{\x - \aspectSectionSize/2 + \interDotGap + \boxSmall*1.42/2 + \k*(\interDotGap + \boxSmall*1.42)};
			\if\k0
				\smallDot{\xCirc}{\y-\aspectBoxHeight}{black}
			\else
				\smallDot{\xCirc}{\y-\aspectBoxHeight}{white}
			\fi
		
		}
		
	
	}
}


%%% ABILITIES BOX
\def\secondColumn{\rightColumn + 1*\widthUnits}
\def\secondRight{100*\widthUnits}
\def\gap{\textcolor{gray!70}{\underline{\hspace{1.8cm}}}}
\draw[rounded corners, gray!70, fill = gray!20] ({\secondColumn},{\halfDivider - 0.5*\heightUnits}) rectangle ({\secondRight},{0});
\node at ({(\secondColumn + \secondRight)/2},{\aspectTop}) {\HP \LARGE Abilities};

\def\interAbilityGap{0.3*\widthUnits}
\def\abilityHeight{2.8*\heightUnits}
\def\abilityWidth{((\secondRight - \secondColumn) - 4 * \interAbilityGap)/3}

\def\columnStart{\aspectTop - 5*\heightUnits}
\foreach \Header/\Column [count = \i from 0] in  {  {Innate}/{{Alertness}, {Bravery}, {Conviction}, {Eloquence}, {Intimidation}, {Kindness}, {Kinship}, {Logic}, {Speed}, {Strength},{\gap{}},{\gap{}} }, {Practical}/{{Acrobatics}, {Brawl}, {Covert}, {Craft}, {Imbue}, {Marksmanship}, {Performance}, {Pilot}, {Skirmish}, {Survival}, {\gap{}},{\gap{}} }, {Knowledge}/{{Arcane}, {General}, {History}, {Investigation}, {Medicine}, {Muggle}, {Nature}, {Science}, {Technology}, {World}, {\gap},{\gap}}, }
{
	\def\x{\secondColumn + \interAbilityGap + \i*(\interAbilityGap + \abilityWidth)}
	
	\node at ({\x+\abilityWidth/2},{\columnStart}) {\key{\Header}};
	
	\foreach \entry [count = \j from 1] in \Column
	{
		\def\y{\columnStart - \interAbilityGap - \j*\abilityHeight}
		
		\node[anchor = west] at ({\x},{\y}) {\footnotesize\imp{\entry}:};
	
		\foreach \k in {0,1,2,3,4,5,6}
		{
			
			\def\xCirc{\x + - 4 * \widthUnits + \abilityWidth - \k*(\boxSmall*1.42)};
			
			\smallDot{\xCirc}{\y}{white}

		
		}
	
	}
	
}	

%%%% Status box 
\def\halfUp{68.4*\heightUnits}
\def\skinnyWidth{23*\widthUnits}
\def\skinnyLimit{\secondColumn + \skinnyWidth}
\draw[rounded corners,gray!70,fill=gray!10] ({\secondColumn},{\halfUp + 0.5*\heightUnits})rectangle ({\skinnyLimit},{\characterBoxTop});

\def\healthGap{0.5*\widthUnits}
\def\healthWidth{(\skinnyWidth - 3*(\healthGap))/2}

%%%Health
\draw[rounded corners,gray!70,fill=gray!30] ({\secondColumn+\healthGap},{\halfUp+ 0.5*\heightUnits+\healthGap})rectangle ({\secondColumn+\healthGap+\healthWidth},{\characterBoxTop-\healthGap});



\def\ytop{\characterBoxTop - 3.1*\healthGap}
\def\x{\secondColumn + \healthGap + (\healthWidth)/2}
\def\xCirc{\secondColumn + \healthGap+0.7*1.42*\boxDim}
\newdimen\healthX
\pgfextractx{\healthX}{\pgfpointxy{{\healthWidth - 1.3*(0.7*1.42+1)*\boxDim}}{0}}


\node at ({\x},{\ytop}) {\key{Health}};

\foreach \a [count = \k from 1] in {{Sore}, {Bruised \hfill (-1d)}, {Hurt \hfill(-2d)}, {Injured\hfill (-3d)}, {Wounded\hfill (-4d)}, {Mangled\hfill (-5d) }, {Critical \\ Condition}  }
{
	\def\yCirc{\ytop -\boxDim*\sqrtTwo*(\k*1.1 + 1/2)}
	\square{\xCirc}{\yCirc}{}{white}
	\node[anchor = west] at ({\xCirc+\boxDim},{\yCirc}) {\parbox[t]{1\healthX}{\scriptsize\imp{\a}}};
}

\def\lineHeight{\ytop - 9*1.42*\boxDim}
\draw[gray!70] ({\secondColumn + \healthGap}, {\lineHeight})--++({\healthWidth},0);
\def\bigH{\lineHeight - \halfUp -0.5*\heightUnits - \healthGap}
\def\deltaH{(\bigH - 2*\sqrtTwo*\boxDim)/3}


\foreach \k in {-1.5,-0.5,0.5,1.5}
{
	\square{\x+\k*1.42*\boxDim}{\lineHeight -\deltaH - \sqrtTwo/2*\boxDim}{dotted}{gray!20}
	\square{\x+\k*1.42*\boxDim}{\lineHeight - \deltaH*2 -  3*\sqrtTwo/2*\boxDim}{dotted}{gray!20}
}


\draw[rounded corners,gray!70,fill=gray!30] ({\secondColumn+2*\healthGap+\healthWidth},{\halfUp+ 0.5*\heightUnits+\healthGap})rectangle ({\skinnyLimit - \healthGap},{\characterBoxTop-\healthGap});

\def\x{\secondColumn + 2* \healthGap + 3/2*(\healthWidth)}
\def\xCirc{\secondColumn + 2*\healthGap + \healthWidth+0.7*1.42*\boxDim}
\node at ({\x},{\ytop}) {\key{Fortitude}};

\foreach \a [count = \k from 1] in {{Fresh}, {Fired Up}, {On A Roll}, {Pushing It}, {Tired}, {Drained}, {Burned Out}  }
{
	\def\yCirc{\ytop -\boxDim*\sqrtTwo*(\k*1.1 + 1/2)}
	\square{\xCirc}{\yCirc}{}{white}
	\node[anchor = west] at ({\xCirc+\boxDim},{\yCirc}) {\parbox[t]{1\healthX}{\scriptsize\imp{\a}}};
}
\def\sqrtTwo{1.4142135623730951}
\draw[gray!70] ({\secondColumn + 2*\healthGap + \healthWidth}, {\lineHeight})--++({\healthWidth},0);
\def\bigH{\lineHeight - \halfUp -0.5*\heightUnits - \healthGap}
\def\deltaH{(\bigH - 2*\sqrtTwo*\boxDim)/3}


\foreach \k in {-1.5,-0.5,0.5,1.5}
{
	\square{\x+\k*1.42*\boxDim}{\lineHeight -\deltaH - \sqrtTwo/2*\boxDim}{dotted}{gray!20}
	\square{\x+\k*1.42*\boxDim}{\lineHeight - \deltaH*2 -  3*\sqrtTwo/2*\boxDim}{dotted}{gray!20}
}




%%% Status Box
\def\heroHeight{5.3*\widthUnits}

\draw[rounded corners,gray!70,fill=gray!10] ({\secondColumn},{\halfUp - 1*\heightUnits - \heroHeight})rectangle ({\skinnyLimit},{\halfDivider + 0.5*\heightUnits});

\def\x{(\skinnyLimit + \secondColumn)/2}
\def\yC{\halfUp -\heroHeight- 4*\heightUnits}

\node at ({\x},{\yC}) {\Large \HP {Negation}};
\def\jump{3*\heightUnits}
\foreach \negate [count = \i from 0] in { {Block}, {Dodge}, {Endure} }
{
	\def\y{\yC - (\i + 1)*\jump}
	
	\node[anchor = west] at ({\secondColumn + \widthUnits},{\y}) {\key{\negate}:};

	\foreach \k in {0,1,2,3,4,5,6}
	{
		
		\def\xCirc{\secondColumn + 11 *\widthUnits + \sqrtTwo*\boxSmall*\k};
		
		%~ \if\k6
			%~ \smallDot{\xCirc}{\y}{black}
		%~ \else
			\smallDot{\xCirc}{\y}{white}
		%~ \fi
	}	

}

%%% HEROISM BOX
\draw[rounded corners,gray!70,fill=gray!10] ({\secondColumn},{\halfUp - 0.5*\heightUnits})rectangle ({\skinnyLimit},{\halfUp - 0.5*\heightUnits-\heroHeight});
\def\yH{\halfUp - 2.1*\heightUnits}
\node at ({\x},{\yH}) {\Large \HP {Heroism \& Villainy}};

\def\yHH{\yH - 3*\heightUnits}
\node[anchor = west] at ({\secondColumn + 0.5*\widthUnits},{\yHH}) {\key{Hero}};
\node[anchor = east] at ({\skinnyLimit - 0.5*\widthUnits},{\yHH}) {\key{Villain}};

\def\delta{(\skinnyLimit - (\secondColumn) - 7*\sqrtTwo*\boxDim)/2}
\foreach \k in {0,1,2,3,4,5,6}
{
	
	\def\xCirc{\secondColumn + \delta + (\k + 2)*\sqrtTwo*\boxSmall };
	
	%~ \if\k6
		%~ \smallDot{\xCirc}{\y}{black}
	%~ \else
		\smallDot{\xCirc}{\yHH}{white}
	%~ \fi
}	




%%%% Spellcasting box
\def\yC{\halfUp - 2.3*\heightUnits}
\def\affinityHeight{\abilityHeight*0.87}
\def\secondLeft{\skinnyLimit + 1*\widthUnits}
\draw[rounded corners,gray!70,fill=gray!10] ({\secondLeft},{\halfUp - 0.5*\heightUnits})rectangle ({\secondRight},{\halfDivider + 0.5*\heightUnits});

\def\xC{(\secondLeft + \secondRight)/2}
\node at ({\xC},{\yC-1*\heightUnits}) {\Large \HP Affinities};

\foreach \Column [count = \i from 0] in  { {{Alteration}, {Bewitchment}, {Cerebral}, {Conjuration}, {Curses}, {Elemental}, {Healing}}, {{Hex}, {Kinesis}, {Occultism}, {Psionics}, {Temporal}, {Warding}, {Necromancy}}, }
{
	\def\x{\secondLeft+ \interAbilityGap + \i*(\interAbilityGap + \abilityWidth*0.93)}
	\foreach \entry [count = \j from 0] in \Column
	{
		\def\y{\yC - 4.3*\heightUnits - \j*\affinityHeight}
		
		\node[anchor = west] at ({\x},{\y}) {\footnotesize\key{\entry}:};
	
		\foreach \k in {0,1,2,3,4,5,6}
		{
			
			\def\xCirc{\x + - 4 * \widthUnits + \abilityWidth - \k*(\boxSmall*1.42)};
			
			%~ \if\k6
				%~ \smallDot{\xCirc}{\y}{black}
			%~ \else
				\smallDot{\xCirc}{\y}{white}
			%~ \fi
		}	
	}
}	




%%%% Inventory Box
\draw[rounded corners,gray!70,fill=gray!10] ({\secondLeft},{\halfUp + 0.5*\heightUnits})rectangle ({\secondRight},{\characterBoxTop});
\def\yC{\characterBoxTop - 1.5*\heightUnits}
\node at ({\xC},{\yC-0.2*\heightUnits}) {\Large \HP Inventory};

\def\wealthHeight{0.5*\heightUnits}
\def\invGap{0.5*\widthUnits}

\def\wealthWidth{6.3*\widthUnits}

\def\invWidth{(\secondRight - (\secondLeft) - 3*\invGap - \wealthWidth)}
\def\subHeight{\yC - 2*\heightUnits}
\def\textHeight{\subHeight - 1*\heightUnits}

\draw[rounded corners,gray!70,fill=gray!30] ({\secondLeft+\invGap},{\halfUp + 0.5*\heightUnits+\wealthHeight})rectangle ({\secondLeft+\invGap + \invWidth},{\subHeight});
\node at ({\secondLeft+\invGap + \invWidth/2},{\textHeight}) {\key{Equipment}};


\def\equipHGap{0.5*\heightUnits}
\def\HStart{\textHeight - 1*\heightUnits}
\def\HEnd{\halfUp + 0.5*\heightUnits +\wealthHeight}
\def\HJump{((\HEnd) - (\HStart) - 8*\equipHGap)/7}

\def\XStart{\secondLeft + \invGap}
\def\XEnd{\secondLeft + \invGap + \invWidth}
\def\XGap{2*\heightUnits}
\def\XJump{((\XEnd) - (\XStart) - 3*\XGap)/2}

\foreach \i in {0,1}
{
	\def\x{\XStart + \XGap + \XJump/2 + \i*(\XJump + \XGap)}
	\foreach \j in {0,1,2,3,4,5,6}
	{
		\def\y{\HStart+\equipHGap + \HJump/2 + \j*(\HJump + \equipHGap)}
		
		\smallDot{\x-\XJump/2}{\y}{white};
		\draw[gray!70]  ({\x-\XJump/2+\sqrtTwo*\boxSmall},{\y-\sqrtTwo/2*\boxSmall})--({\x+\XJump/2},{\y-\sqrtTwo/2*\boxSmall});
	}
}




\draw[rounded corners,gray!70,fill=gray!30] ({\secondLeft+2*\invGap + \invWidth},{\halfUp + 0.5*\heightUnits+\wealthHeight})rectangle ({\secondRight - \invGap},{\subHeight});
\def\xW{\secondRight - \invGap - \wealthWidth/2}
\node at ({\xW},{\textHeight}) {\small \key{Galleons}};
\def\moneyGap{(\boxDim*1.42)}
\foreach \k in {0,1,2,3,4,5,6}
{
	
	\def\yCirc{\textHeight - (\k+1)*\moneyGap};
	
	\square{\xW}{\yCirc}{}{white}

}	
\node at ({\xW},{\textHeight - 8*\moneyGap}) {\small \imp{Vault}};

\def\vaultY{\textHeight - 9.3*\moneyGap};

\def\vaultSize{3.3*\widthUnits}
\draw[] ({\xW - \vaultSize/2},{\vaultY - \vaultSize/2}) rectangle ({\xW + \vaultSize/2},{\vaultY + \vaultSize/2});
\def\vaultSize{3*\widthUnits}
\draw[fill=white] ({\xW - \vaultSize/2},{\vaultY - \vaultSize/2}) rectangle ({\xW + \vaultSize/2},{\vaultY + \vaultSize/2});

\end{tikzpicture}

\end{landscape}



\end{document}
