professions = readtable('weapons.xlsx');
professions = sortrows(professions);
professions = sortrows(professions,2);
professions = sortrows(professions,3);

fileName = '../Chapters/CharacterCreation.tex';
readFile = fileread(fileName);


insertPoint = strfind(readFile, '%%WeaponsBegin');

endPoint = strfind(readFile, '%%WeaponsEnd');

firstHalf = readFile(1:insertPoint+13);

secondHalf = readFile(endPoint:end);


preamble = '\begin{center} \begin{table}{|c|c|c|c|c|c|c|}';
headers = '\hline \normalsize \bf Weapon & \normalsize \bf Type & \normalsize \bf Brawler Level & \normalsize \bf Damage Check & \normalsize \bf Damage Type \\ \hline \hline ';

text = [preamble headers];

n = size(professions);

for (i = 1:n)
    line = ['\bf ' professions.Weapon{i}, ' &  '
    text = [text line];
end
ender = '\end{table} \end{center}';

fullText = [firstHalf, text, ender, secondHalf];

FID = fopen(fileName,'w');
fwrite(FID, fullText);
